<!DOCTYPE html>
<html>
<head>
<title>Faux Hollows Solver</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script>
var deadColor = 'grey';
var missColor = 'firebrick';
var smallColor = 'purple';
var medColor = 'lawngreen';
var largeColor = 'lightseagreen';

window.addEventListener("DOMContentLoaded", function() {
	$('.block').each(function(i, obj) {
		$(this).hover(function() {
			$(this).stop(false, false);
			$(this).fadeTo('fast', 1);
		}, function() {
			$(this).stop(false, false);
			$(this).fadeTo('fast', 0.9);
		});
		$(this).click(function() {
			$(this).stop(false, true);
			var radioValue = $("input[name='menu']:checked").val();
			switch (radioValue) {
				case 'deadcell':
					if ($(this).css('background-color') == "rgb(255, 255, 255)") {
						$(this).stop().css('background-color', deadColor);
						$(this).attr('name', deadColor);
					} else if ($(this).attr('name') == deadColor) {
						$(this).stop().css('background-color', 'white');
						$(this).removeAttr('name');
					} else {
						$(this).stop().css('background-color', deadColor);
						$(this).attr('name', deadColor);
					}
					break;
				case 'miss':
					if ($(this).css('background-color') == "rgb(255, 255, 255)") {
						$(this).stop().css('background-color', missColor);
						$(this).attr('name', missColor);
					} else if ($(this).attr('name') == missColor) {
						$(this).stop().css('background-color', 'white');
						$(this).removeAttr('name');
					} else {
						$(this).stop().css('background-color', missColor);
						$(this).attr('name', missColor);
					}
					break;
				case 'small':
					if ($(this).css('background-color') == "rgb(255, 255, 255)") {
						$(this).stop().css('background-color', smallColor);
						$(this).attr('name', smallColor);
					} else if ($(this).attr('name') == smallColor) {
						$(this).stop().css('background-color', 'white');
						$(this).removeAttr('name');
					} else {
						$(this).stop().css('background-color', smallColor);
						$(this).attr('name', smallColor);
					}
					break;
				case 'medium':
					if ($(this).css('background-color') == "rgb(255, 255, 255)") {
						$(this).stop().css('background-color', medColor);
						$(this).attr('name', medColor);
					} else if ($(this).attr('name') == medColor) {
						$(this).stop().css('background-color', 'white');
						$(this).removeAttr('name');
					} else {
						$(this).stop().css('background-color', medColor);
						$(this).attr('name', medColor);
					}
					break;
				case 'large':
					if ($(this).css('background-color') == "rgb(255, 255, 255)") {
						$(this).stop().css('background-color', largeColor);
						$(this).attr('name', largeColor);
					} else if ($(this).attr('name') == largeColor) {
						$(this).stop().css('background-color', 'white');
						$(this).removeAttr('name');
					} else {
						$(this).stop().css('background-color', largeColor);
						$(this).attr('name', largeColor);
					}
					break;
				case 'clear':
					$(this).stop().css('background-color', 'white');
					$(this).removeAttr('name');
					break;
				default:
					break;
			}
		});
	});
});


function reset() {
	$('.block').each(function(i, obj) {
		$(this).stop();
		$(this).css('background-color', 'white');
		$(this).removeAttr('name');
	});
	window.currentScores = Prefilled2DArray(6, 6, 0);
	ShowScoresInBlocks();
}

function ChangeBoxLabel() {
	if ($("input[name='boxtype']:checked").val() == "coffer") {
		$("#boxlabel").html("Coffer");
		$("#menuitemhitmedbox").html("Coffer");
		$('#medstratlabel').html("Coffer");
		if ($("#medWeight").val() == 10) {
			$("#medWeight").val(20)
		}
	} else {
		$("#boxlabel").html("Gift Box");
		$("#menuitemhitmedbox").html("Gift Box");
		$('#medstratlabel').html("Gift Box");
		if ($("#medWeight").val() == 20) {
			$("#medWeight").val(10)
		}
	}
}

var currentScores = Prefilled2DArray(6, 6, 0);

var currentGrid = [];

function ParseGrid() {
	window.currentGrid = Prefilled2DArray(6, 6, 0);
	for (var i = 0; i < 6; i++) {
		for (var j = 0; j < 6; j++) {
			var blockName = $('#container' + (1 + j + 6 * i)).attr('name');
			if (blockName == "") {
				window.currentGrid[i][j] = 0;
			}
			if (blockName == deadColor) {
				window.currentGrid[i][j] = 1;
			}
			if (blockName == missColor) {
				window.currentGrid[i][j] = 2;
			}
			if (blockName == smallColor) {
				window.currentGrid[i][j] = 3;
			}
			if (blockName == medColor) {
				window.currentGrid[i][j] = 4;
			}
			if (blockName == largeColor) {
				window.currentGrid[i][j] = 5;
			}
		}
	}
}

function MakePrediction() {
	var maxScore = 0;
	for (var i = 0; i < 6; i++) {
		for (var j = 0; j < 6; j++) {
			var box = $('#container' + (i * 6 + 1 + j));
			if (box.attr('name') == 'prediction') {
				box.css('background-color', 'white');
				box.removeAttr('name');
			}
			if (box.attr('name') == undefined) {
				maxScore = Math.max(currentScores[i][j], maxScore);
			}
		}
	}
	if (maxScore != 0) {
		for (var i = 0; i < 6; i++) {
			for (var j = 0; j < 6; j++) {
				var box = $('#container' + (i * 6 + 1 + j))
				if (currentScores[i][j] == maxScore && box.attr('name') == undefined) {
					box.css('background-color', 'gold');
					box.attr('name', 'prediction');
				}
			}
		}
	}
}

function ShowScoresInBlocks() {
	if ($('#showvalue').is(':checked')) {
		for (var i = 0; i < 6; i++) {
			for (var j = 0; j < 6; j++) {
				var box = $('#container' + (i * 6 + j + 1));
				if (box.attr('name') == undefined || box.attr('name') == 'prediction') {
					var htmlstring = "<span>";
					htmlstring += (window.currentScores[i][j] * 100).toFixed(2);
					htmlstring += "</span>";
					box.html(htmlstring);
				} else {
					box.html("");
				}
			}
		}
	} else {
		for (var i = 0; i < 6; i++) {
			for (var j = 0; j < 6; j++) {
				$('#container' + (i * 6 + j + 1)).html("");
			}
		}
	}
}

function MarkGuaranteedBlocks() {
	var largeHit = 0;
	var medHit = 0;

	// Check for hits
	for (var i = 0; i < 6; i++) {
		for (var j = 0; j < 6; j++) {
			if (window.currentGrid[i][j] == 5) {
				largeHit++;
			} else if (window.currentGrid[i][j] == 4) {
				medHit++;
			}
		}
	}

	// Square
	if (medHit > 0) {
		var medMap = NaiiveMedProb();
		for (var i = 0; i < 6; i++) {
			for (var j = 0; j < 6; j++) {
				if (medMap[i][j] == 1 && window.currentGrid[i][j] != 4) {
					window.currentGrid[i][j] = 4;
					var number = i * 6 + j + 1;
					$('#container' + number).css('background-color', medColor).attr('name', medColor);
				}
			}
		}
	}

	// Large
	if (largeHit > 0) {
		var largeMap = NaiiveLargeProb();
		for (var i = 0; i < 6; i++) {
			for (var j = 0; j < 6; j++) {
				if (largeMap[i][j] == 1 && window.currentGrid[i][j] != 5) {
					window.currentGrid[i][j] = 5;
					var number = i * 6 + j + 1;
					$('#container' + number).css('background-color', largeColor).attr('name', largeColor);
				}
			}
		}
	}
}

function runGuaranteed() {
	ParseGrid();
	MarkGuaranteedBlocks();
	var probs = CalculateFullProb();
	var strategy = $("input[name='strategy']:checked").val();
	switch (strategy) {
		case 'strat1':
			window.currentScores = fullProbScores(probs);
			break;
		case 'strat2':
			window.currentScores = weightedScores(probs);
			break;
		case 'strat3':
			window.currentScores = swordsScores(probs);
			break;
		case 'strat4':
			window.currentScores = boxScores(probs);
			break;
		case 'strat5':
			window.currentScores = foxScores(probs);
			break;
		default:
			break;
	}
	ShowScoresInBlocks();
	MakePrediction();
}

function LiveUpdate() {
	if ($('#liveupdate').is(':checked')) {
		setTimeout(runGuaranteed, 100);
	}
}

function fullProbScores(probs) {
	var newScores = Prefilled2DArray(6, 6, 0);
	for (var i = 0; i < 6; i++) {
		for (var j = 0; j < 6; j++) {
			var newProb = (1 - probs[0][i][j]) * (1 - probs[1][i][j]) * (1 - probs[2][i][j]);
			newProb = 1 - newProb;
			newScores[i][j] = newProb;
		}
	}
	return newScores;
}

function weightedScores(probs) {
	var newScores = Prefilled2DArray(6, 6, 0);
	for (var i = 0; i < 6; i++) {
		for (var j = 0; j < 6; j++) {
			var foxWeighted = probs[0][i][j] * $('#smallWeight').val();
			var boxWeighted = probs[1][i][j] * $('#medWeight').val();
			var swordsWeighted = probs[2][i][j] * $('#largeWeight').val();
			newScores[i][j] = foxWeighted + boxWeighted + swordsWeighted;
		}
	}
	return newScores;
}

function swordsScores(probs) {
	return probs[2];
}

function boxScores(probs) {
	return probs[1];
}

function foxScores(probs) {
	return probs[0];
}

function NaiiveLargeProb() {
	var hitCount = 0;
	var hitMap = Prefilled2DArray(6, 6, 0);
	var probCount = 0;
	var hitLoc = [];

	//Check for previous hit
	for (var i = 0; i < 6; i++) {
		for (var j = 0; j < 6; j++) {
			if (window.currentGrid[i][j] == 5) {
				if (hitCount == 0) {
					hitLoc = [i, j];
				}
				hitCount++;
			}
		}
	}

	if (hitCount > 0) {

		//Horizontals
		for (var i = 0; i < 2; i++) {
			for (var j = 0; j < 3; j++) {
				if (hitLoc[0] - (1 - i) < 0 || hitLoc[0] + i > 5 ||
					hitLoc[1] - (2 - j) < 0 || hitLoc[1] + j > 5) {
					continue;
				}
				var coords = [
					[hitLoc[0] - (1 - i), hitLoc[1] - (2 - j)],
					[hitLoc[0] - (1 - i), hitLoc[1] - (1 - j)],
					[hitLoc[0] - (1 - i), hitLoc[1] + j],
					[hitLoc[0] + i, hitLoc[1] - (2 - j)],
					[hitLoc[0] + i, hitLoc[1] - (1 - j)],
					[hitLoc[0] + i, hitLoc[1] + j]
				];
				var blocks = [];
				blocks.push(window.currentGrid[coords[0][0]][coords[0][1]]);
				blocks.push(window.currentGrid[coords[1][0]][coords[1][1]]);
				blocks.push(window.currentGrid[coords[2][0]][coords[2][1]]);
				blocks.push(window.currentGrid[coords[3][0]][coords[3][1]]);
				blocks.push(window.currentGrid[coords[4][0]][coords[4][1]]);
				blocks.push(window.currentGrid[coords[5][0]][coords[5][1]]);
				var count = 0;
				var hasObstacle = false;
				for (var k = 0; k < 6; k++) {
					if (blocks[k] == 5) {
						count++;
					} else if (blocks[k] != 0) {
						hasObstacle = true;
						break;
					}
				}
				if (!hasObstacle && count == hitCount) {
					hitMap[coords[0][0]][coords[0][1]]++;
					hitMap[coords[1][0]][coords[1][1]]++;
					hitMap[coords[2][0]][coords[2][1]]++;
					hitMap[coords[3][0]][coords[3][1]]++;
					hitMap[coords[4][0]][coords[4][1]]++;
					hitMap[coords[5][0]][coords[5][1]]++;
					probCount++;
				}
			}
		}

		//Verticals
		for (var i = 0; i < 3; i++) {
			for (var j = 0; j < 2; j++) {
				if (hitLoc[0] - (2 - i) < 0 || hitLoc[0] + i > 5 ||
					hitLoc[1] - (1 - j) < 0 || hitLoc[1] + j > 5) {
					continue;
				}
				var coords = [
					[hitLoc[0] - (2 - i), hitLoc[1] - (1 - j)],
					[hitLoc[0] - (1 - i), hitLoc[1] + j],
					[hitLoc[0] + i, hitLoc[1] - (1 - j)],
					[hitLoc[0] - (2 - i), hitLoc[1] + j],
					[hitLoc[0] - (1 - i), hitLoc[1] - (1 - j)],
					[hitLoc[0] + i, hitLoc[1] + j]
				];
				var blocks = [];
				blocks.push(window.currentGrid[coords[0][0]][coords[0][1]]);
				blocks.push(window.currentGrid[coords[1][0]][coords[1][1]]);
				blocks.push(window.currentGrid[coords[2][0]][coords[2][1]]);
				blocks.push(window.currentGrid[coords[3][0]][coords[3][1]]);
				blocks.push(window.currentGrid[coords[4][0]][coords[4][1]]);
				blocks.push(window.currentGrid[coords[5][0]][coords[5][1]]);
				var count = 0;
				var hasObstacle = false;
				for (var k = 0; k < 6; k++) {
					if (blocks[k] == 5) {
						count++;
					} else if (blocks[k] != 0) {
						hasObstacle = true;
						break;
					}
				}
				if (!hasObstacle && count == hitCount) {
					hitMap[coords[0][0]][coords[0][1]]++;
					hitMap[coords[1][0]][coords[1][1]]++;
					hitMap[coords[2][0]][coords[2][1]]++;
					hitMap[coords[3][0]][coords[3][1]]++;
					hitMap[coords[4][0]][coords[4][1]]++;
					hitMap[coords[5][0]][coords[5][1]]++;
					probCount++;
				}
			}
		}

		for (var i = 0; i < 6; i++) {
			for (var j = 0; j < 6; j++) {
				hitMap[i][j] /= probCount;
			}
		}

		return hitMap;
	}

	//Horizontal
	for (var i = 0; i < 4; i++) {
		for (var j = 0; j < 5; j++) {
			var block1 = window.currentGrid[i][j];
			var block2 = window.currentGrid[i][j + 1];
			var block3 = window.currentGrid[i][j + 2];
			var block4 = window.currentGrid[i + 1][j];
			var block5 = window.currentGrid[i + 1][j + 1];
			var block6 = window.currentGrid[i + 1][j + 2];
			if (block1 != 0 ||
				block2 != 0 ||
				block3 != 0 ||
				block4 != 0 ||
				block5 != 0 ||
				block6 != 0) {
				continue;
			} else {
				hitMap[i][j]++;
				hitMap[i][j + 1]++;
				hitMap[i][j + 2]++;
				hitMap[i + 1][j]++;
				hitMap[i + 1][j + 1]++;
				hitMap[i + 1][j + 2]++;
				probCount++;
			}

		}
	}

	//Vertical
	for (var i = 0; i < 5; i++) {
		for (var j = 0; j < 4; j++) {
			var block1 = window.currentGrid[i][j];
			var block2 = window.currentGrid[i][j + 1];
			var block3 = window.currentGrid[i + 1][j];
			var block4 = window.currentGrid[i + 1][j + 1];
			var block5 = window.currentGrid[i + 2][j];
			var block6 = window.currentGrid[i + 2][j + 1];
			if (block1 != 0 ||
				block2 != 0 ||
				block3 != 0 ||
				block4 != 0 ||
				block5 != 0 ||
				block6 != 0) {
				continue;
			} else {

			}
		}
	}

	for (var i = 0; i < 6; i++) {
		for (var j = 0; j < 6; j++) {
			hitMap[i][j] /= probCount;
		}
	}

	return hitMap;


}

//	Probability of a medium in a spot without factoring in other logos
function NaiiveMedProb() {
	var map = Prefilled2DArray(6, 6, 0);
	var count = 0;
	var hitCount = 0;
	var hitLoc = [];

	for (var i = 0; i < 6; i++) {
		for (var j = 0; j < 6; j++) {
			if (window.currentGrid[i][j] == 4) {
				hitCount++;
				hitLoc = [i, j];
			}
		}
	}

	if (hitCount > 0) {
		for (var i = -1; i < 1; i++) {
			for (var j = -1; j < 1; j++) {
				if (hitLoc[0] + i < 0 || hitLoc[0] + 1 + i > 5 ||
					hitLoc[1] + j < 0 || hitLoc[1] + 1 + j > 5) {
					continue;
				}
				var coords = [
					[hitLoc[0] + i, hitLoc[1] + j],
					[hitLoc[0] + i, hitLoc[1] + j + 1],
					[hitLoc[0] + i + 1, hitLoc[1] + j],
					[hitLoc[0] + i + 1, hitLoc[1] + j + 1]
				];
				var tempCount = 0;
				var noObstacles = true;
				for (var k = 0; k < 4; k++) {
					if (window.currentGrid[coords[k][0]][coords[k][1]] == 4) {
						tempCount++;
					} else if (window.currentGrid[coords[k][0]][coords[k][1]] != 0) {
						noObstacles = false;
						break;
					}
				}
				if (noObstacles && tempCount == hitCount) {
					for (var k = 0; k < 4; k++) {
						map[coords[k][0]][coords[k][1]]++;
					}
					count++;
				}
			}
		}
	} else {
		for (var i = 0; i < 5; i++) {
			for (var j = 0; j < 5; j++) {
				if (window.currentGrid[i][j] != 0 || window.currentGrid[i][j + 1] != 0 ||
					window.currentGrid[i + 1][j] != 0 || window.currentGrid[i + 1][j + 1] != 0) {
					continue;
				} else {
					count++;
					map[i][j]++;
					map[i][j + 1]++;
					map[i + 1][j]++;
					map[i + 1][j + 1]++;
				}
			}
		}
	}
	//Turn into probabilities
	for (var i = 0; i < 6; i++) {
		for (var j = 0; j < 6; j++) {
			map[i][j] /= count;
		}
	}
	return map;
}

function CalculateFullProb() {
	var hitMap = Prefilled3DArray(6, 6, 3, 0);
	var hitCount = 0;
	var currentHits = [0, 0, 0];

	for (var i = 0; i < 6; i++) {
		for (var j = 0; j < 6; j++) {
			if (currentGrid[i][j] == 3) {
				currentHits[0]++;
			}
			if (currentGrid[i][j] == 4) {
				currentHits[1]++;
			}
			if (currentGrid[i][j] == 5) {
				currentHits[2]++;
			}
		}
	}

	//LOTS OF FOR LOOPS INCOMING
	/*
	Method:
	
	For every placement of the small
		if placement contains currently placed small
			For every placement of the medium given each placement of small
				if placement contains all currently placed mediums
					Again for each orientation of the large
						if placement contains all currently placed larges
							Count placements for all shapes
	
	This should give all possible placements of all three given the current board
	*/
	for (var iSm = 0; iSm < 6; iSm++) {
		for (var jSm = 0; jSm < 6; jSm++) {
			if ((currentGrid[iSm][jSm] == 0 && currentHits[0] == 0) ||
				(currentGrid[iSm][jSm] == 3 && currentHits[0] != 0)) {

				var gridSmallAdded = JSON.parse(JSON.stringify(window.currentGrid));
				gridSmallAdded[iSm][jSm] = 3;


				for (var iMed = 0; iMed < 5; iMed++) {
					for (var jMed = 0; jMed < 5; jMed++) {

						var smallBlocks = [
							gridSmallAdded[iMed][jMed],
							gridSmallAdded[iMed][jMed + 1],
							gridSmallAdded[iMed + 1][jMed],
							gridSmallAdded[iMed + 1][jMed + 1]
						];

						var smallTotalInPlacement = 0;
						for (var i = 0; i < 4; i++) {
							if (smallBlocks[i] == 4) {
								smallTotalInPlacement++;
							}
						}

						if (smallTotalInPlacement == currentHits[1] &&
							(smallBlocks[0] == 0 || smallBlocks[0] == 4) &&
							(smallBlocks[1] == 0 || smallBlocks[1] == 4) &&
							(smallBlocks[2] == 0 || smallBlocks[2] == 4) &&
							(smallBlocks[3] == 0 || smallBlocks[3] == 4)) {

							var gridMedAdded = JSON.parse(JSON.stringify(gridSmallAdded));
							gridMedAdded[iMed][jMed] = 4;
							gridMedAdded[iMed][jMed + 1] = 4;
							gridMedAdded[iMed + 1][jMed] = 4;
							gridMedAdded[iMed + 1][jMed + 1] = 4;

							//Horizontal Larges
							for (var iLg = 0; iLg < 5; iLg++) {
								for (var jLg = 0; jLg < 4; jLg++) {

									var largeBlocks = [
										gridMedAdded[iLg][jLg],
										gridMedAdded[iLg][jLg + 1],
										gridMedAdded[iLg][jLg + 2],
										gridMedAdded[iLg + 1][jLg],
										gridMedAdded[iLg + 1][jLg + 1],
										gridMedAdded[iLg + 1][jLg + 2]
									];

									var largeTotalInPlacement = 0;
									for (var j = 0; j < 6; j++) {
										if (largeBlocks[j] == 5) {
											largeTotalInPlacement++;
										}
									}

									if (largeTotalInPlacement == currentHits[2] &&
										(largeBlocks[0] == 0 || largeBlocks[0] == 5) &&
										(largeBlocks[1] == 0 || largeBlocks[1] == 5) &&
										(largeBlocks[2] == 0 || largeBlocks[2] == 5) &&
										(largeBlocks[3] == 0 || largeBlocks[3] == 5) &&
										(largeBlocks[4] == 0 || largeBlocks[4] == 5) &&
										(largeBlocks[5] == 0 || largeBlocks[5] == 5)) {

										hitMap[iSm][jSm][0]++;

										hitMap[iMed][jMed][1]++;
										hitMap[iMed][jMed + 1][1]++;
										hitMap[iMed + 1][jMed][1]++;
										hitMap[iMed + 1][jMed + 1][1]++;

										hitMap[iLg][jLg][2]++;
										hitMap[iLg][jLg + 1][2]++;
										hitMap[iLg][jLg + 2][2]++;
										hitMap[iLg + 1][jLg][2]++;
										hitMap[iLg + 1][jLg + 1][2]++;
										hitMap[iLg + 1][jLg + 2][2]++;
										hitCount++;
									}
								}
							} // End Horizontal Larges

							//Vertical Larges
							for (var iLg = 0; iLg < 4; iLg++) {
								for (var jLg = 0; jLg < 5; jLg++) {

									var largeBlocks = [
										gridMedAdded[iLg][jLg],
										gridMedAdded[iLg][jLg + 1],
										gridMedAdded[iLg + 1][jLg],
										gridMedAdded[iLg + 1][jLg + 1],
										gridMedAdded[iLg + 2][jLg],
										gridMedAdded[iLg + 2][jLg + 1]
									];

									var largeTotalInPlacement = 0;
									for (var j = 0; j < 6; j++) {
										if (largeBlocks[j] == 5) {
											largeTotalInPlacement++;
										}
									}

									if (largeTotalInPlacement == currentHits[2] &&
										(largeBlocks[0] == 0 || largeBlocks[0] == 5) &&
										(largeBlocks[1] == 0 || largeBlocks[1] == 5) &&
										(largeBlocks[2] == 0 || largeBlocks[2] == 5) &&
										(largeBlocks[3] == 0 || largeBlocks[3] == 5) &&
										(largeBlocks[4] == 0 || largeBlocks[4] == 5) &&
										(largeBlocks[5] == 0 || largeBlocks[5] == 5)) {

										hitMap[iSm][jSm][0]++;

										hitMap[iMed][jMed][1]++;
										hitMap[iMed][jMed + 1][1]++;
										hitMap[iMed + 1][jMed][1]++;
										hitMap[iMed + 1][jMed + 1][1]++;

										hitMap[iLg][jLg][2]++;
										hitMap[iLg][jLg + 1][2]++;
										hitMap[iLg + 1][jLg][2]++;
										hitMap[iLg + 1][jLg + 1][2]++;
										hitMap[iLg + 2][jLg][2]++;
										hitMap[iLg + 2][jLg + 1][2]++;
										hitCount++;
									}
								}
							} // End Vertical Larges
						}
					}
				} // End Mediums
			}
		}
	} // End Smalls

	// Probabilities Time

	//LARGE HIT COUNT IS THE SAME AS TOTAL BOARD CONFIGS
	//Formula: number of hits/total board configs
	var probabilityMaps = [
		Prefilled2DArray(6, 6, 0),
		Prefilled2DArray(6, 6, 0),
		Prefilled2DArray(6, 6, 0)
	];

	for (var i = 0; i < 6; i++) {
		for (var j = 0; j < 6; j++) {
			probabilityMaps[0][i][j] = hitMap[i][j][0] / hitCount;
			probabilityMaps[1][i][j] = hitMap[i][j][1] / hitCount;
			probabilityMaps[2][i][j] = hitMap[i][j][2] / hitCount;
		}
	}

	return probabilityMaps;
}

// Stolen from Stackoverflow @Tyler
function Prefilled2DArray(height, width, value) {
	return Array.from(Array(height), _ => Array(width).fill(value));
}

// But not this one
function Prefilled3DArray(height, width, depth, value) {
	return Array.from(Array(height), _ => Array.from(Array(width), _ => Array(depth).fill(value)));
}

</script>
<style>
body {
	background-color: #202020;
}

#contentwrapper {
	display: flex;
	justify-content: center;
}

#contentbox {
	width: 803px;
}

#titlebar {
	position: absolute;
	text-align: center;
	top: 10px;
	margin-left: 10px;
	background-color: #3a3a3a;
	width: 793px;
	height: 75px;
	border-radius: 8px;
}

h2 {
	color: white;
	font: 50px Calibri;
	margin-top: 7px;
}

#calccontainer {
	position: absolute;
	width: 1080px;
	top: 102px;
	margin-left: 10px;
}

#sidebar {
	position: relative;
	float: left;
	background-color: #3a3a3a;
	width: 200px;
	height: 500px;
	padding: 1.666666666667%;
	border-radius: 8px;
}

#picker {
	margin-left: 7px;
	width: 100%;
	height: 21%;
	display: flex;
	flex-wrap: wrap;
	justify-content: center;
	align-items: center;
}

.radiocontainer {
	width: 50%;
	margin-bottom: 25px;
}

.radiolabel {
	display: block;
	position: relative;
	padding-bottom: 12px;
	cursor: pointer;
	font-size: 18px;
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;
}

.radiolabel input {
	position: absolute;
	opacity: 0;
	cursor: pointer;
	height: 0;
	width: 0;
}

.radiobox {
	position: absolute;
	top: 0;
	left: 0;
	height: 25px;
	width: 80%;
	border: 3px;
	border-style: solid;
	border-radius: 3px;
	color: white;
	font: 18px Calibri;
	opacity: 0.75;
	text-align: center;
	transition: opacity 0.5s cubic-bezier(0.2, 0.4, 0.3, 1);
	-webkit-transition: opacity 0.5s cubic-bezier(0.4, 0, 0.3, 1);
	-moz-transition: opacity 0.5s cubic-bezier(0.4, 0, 0.3, 1);
}

#menuitemdeadcellbox {
	background-color: grey;
	border-color: grey;
}

.radiolabel input:checked~#menuitemdeadcellbox {
	border-color: gold;
}

#menuitemmissbox {
	background-color: firebrick;
	border-color: firebrick;
}

.radiolabel input:checked~#menuitemmissbox {
	border-color: gold;
}

#menuitemhitmedbox {
	color: black;
	font-weight: bold;
	background-color: lawngreen;
	border-color: lawngreen;
}

.radiolabel input:checked~#menuitemhitmedbox {
	border-color: gold;
}

#menuitemhitlargebox {
	background-color: lightseagreen;
	border-color: lightseagreen;
}

.radiolabel input:checked~#menuitemhitlargebox {
	border-color: gold;
}

#menuitemhitsmallbox {
	background-color: purple;
	border-color: purple;
}

.radiolabel input:checked~#menuitemhitsmallbox {
	border-color: gold;
}

#menuitemclearbox {
	color: black;
	font-weight: bold;
	background-color: white;
	border-color: white;
}

.radiolabel input:checked~#menuitemclearbox {
	border-color: gold;
}

.radiolabel:hover input~.radiobox {
	opacity: 1;
}

.radiolabel input:checked~.radiobox {
	opacity: 1;
}

.testradio:after {
	content: "";
	position: absolute;
	display: none;
}

.radiolabel input:checked~.radiobox:after {
	display: block;
}

.menulabel {
	width: 50%;
	font: 18px Calibri;
	color: white;
}

.menulabelsmall {
	width: 50%;
	font: 16px Calibri;
	color: white;
	margin-bottom: 0;
}

h1 {
	margin: 10px;
	margin-left: 0;
	margin-bottom: 3px;
	margin-top: 3px;
	font: 25px Calibri;
	color: darksalmon;
}

.weights {
	font: 18px Calibri;
	width: 80px;
}

#scorebox {
	margin-top: 8px;
}

#buttongroup {
	position: absolute;
	display: inline-block;
	bottom: 10px;
	left: 10px;
}

.menubutton {
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;
}

input[type=checkbox] {
	-ms-transform: scale(1.3);
	-moz-transform: scale(1.3);
	-webkit-transform: scale(1.3);
	-o-transform: scale(1.3);
	transform: scale(1.3);
}

#liveupdatelabel {
	font: 14px Calibri;
	color: white;
}

#wrapper {
	position: relative;
	float: left;
	margin-left: 20px;
	background-color: #3a3a3a;
	width: 500px;
	height: 500px;
	padding: 1.6666666667%;
	border-radius: 8px;
}

.block {
	color: black;
	display: flex;
	align-items: center;
	justify-content: center;
	background-color: white;
	width: 13.3333333%;
	min-height 13.3333333%;
	height: 13.3333333%;
	float: left;
	font: 18px Calibri;
	text-align: center;
	border-radius: 5px;
	margin: 1.66666667%;
	opacity: 0.9;
	cursor: pointer;
	transition: background-color 0.5s cubic-bezier(0.4, 0, 0.3, 1);
	-webkit-transition: background-color 0.5s cubic-bezier(0.4, 0, 0.3, 1);
	-moz-transition: background-color 0.5s cubic-bezier(0.4, 0, 0.3, 1);
	-moz-user-select: none;
	-webkit-user-select: none;
	-ms-user-select: none;
	user-select: none;
	-o-user-select: none;
}

#descriptionbox {
	position: absolute;
	top: 655px;
	margin-left: 10px;
	background-color: #3a3a3a;
	width: 793px;
	min-height: 100px;
	padding-bottom: 10px;
	border-radius: 8px;
	display: flex;
	flex-direction: column;
}

h3 {
	color: darksalmon;
	margin: 5px;
	font: 24px Calibri;
	text-align: center;
}

.description {
	color: white;
	font: 17px Calibri;
	margin-left: 20px;
	word-wrap: break-word;
}

.indented {
	padding-left: 40px;
}

.signature {
	color: white;
	font: 14px Calibri;
	margin-top: 20px;
	margin-left: 20px;
	text-align: center;
}

</style>
</head>
<body>
	<div id="contentwrapper">
		<div id="contentbox">
			<div id="titlebar">
				<h2>
					Faux Hollows Solver
				</h2>
			</div>
			<div id="calccontainer">
				<div id="sidebar">
					<form action id="picker">
						<div class="radiocontainer">
							<label for="menuitemdeadcell" class="radiolabel">
								<input type="radio" id="menuitemdeadcell" name="menu" value="deadcell" checked>
								<span id="menuitemdeadcellbox" class="radiobox">Blocked</span>
							</label>
						</div>
						<div class="radiocontainer">
							<label for="menuitemmiss" class="radiolabel">
								<input type="radio" id="menuitemmiss" name="menu" value="miss">
								<span id="menuitemmissbox" class="radiobox">Empty</span>
							</label>
						</div>
						<div class="radiocontainer">
							<label for="menuitemhitmed" class="radiolabel">
								<input type="radio" id="menuitemhitmed" name="menu" value="medium">
								<span id="menuitemhitmedbox" class="radiobox">Coffer</span>
							</label>
						</div>
						<div class="radiocontainer">
							<label for="menuitemhitlarge" class="radiolabel">
								<input type="radio" id="menuitemhitlarge" name="menu" value="large">
								<span id="menuitemhitlargebox" class="radiobox">Swords</span>
							</label>
						</div>
						<div class="radiocontainer">
							<label for="menuitemhitsmall" class="radiolabel">
								<input type="radio" id="menuitemhitsmall" name="menu" value="small">
								<span id="menuitemhitsmallbox" class="radiobox">Fox</span>
							</label>
						</div>
						<div class="radiocontainer">
							<label for="menuitemclear" class="radiolabel">
								<input type="radio" id="menuitemclear" name="menu" value="clear">
								<span id="menuitemclearbox" class="radiobox">Clear</span>
							</label>
						</div>
					</form>
					<div>
						<h1>2x2 Type</h1>
						<form action>
							<div>
								<input onclick="ChangeBoxLabel()" type="radio" id="boxtypecoffer" name="boxtype" value="coffer" Checked>
								<label for="boxtypecoffer" class="menulabel">Coffer</label>
							</div>
							<div>
								<input onclick="ChangeBoxLabel()" type="radio" id="boxtypegift" name="boxtype" value="gift">
								<label for="boxtypegift" class="menulabel">Gift Box</label>
							</div>
						</form>
					</div>
					<div>
						<h1>Strategy</h1>
						<form action>
							<div>
								<input type="radio" id="strategy1" name="strategy" value="strat1" onclick="LiveUpdate();" Checked>
								<label for="strategy1" class="menulabelsmall">Pure Probability</label>
							</div>
							<div>
								<input type="radio" id="strategy2" name="strategy" value="strat2" onclick="LiveUpdate();">
								<label for="strategy2" class="menulabelsmall">Weighted</label>
							</div>
							<div>
								<input type="radio" id="strategy3" name="strategy" value="strat3" onclick="LiveUpdate();">
								<label id="medstratlabel" for="strategy3" class="menulabelsmall">Swords</label>
							</div>
							<div>
								<input type="radio" id="strategy4" name="strategy" value="strat4" onclick="LiveUpdate();">
								<label for="strategy4" class="menulabelsmall">Coffer</label>
							</div>
							<div>
								<input type="radio" id="strategy5" name="strategy" value="strat5" onclick="LiveUpdate();">
								<label for="strategy5" class="menulabelsmall">Fox</label>
							</div>
						</form>
					</div>
					<div>
						<h1>Weights</h1>
						<div>
							<input id="smallWeight" type="number" value="100" pattern="[0-9]" min=0 max=100 class='weights'>
							<label class="menulabel">Fox</label>
						</div>
						<div>
							<input id="medWeight" type="number" value="20" pattern="[0-9]" min=0 max=100 class='weights'>
							<label id="boxlabel" class="menulabel">Coffer</label>
						</div>
						<div>
							<input id="largeWeight" type="number" value="10" pattern="[0-9]" min=0 max=100 class='weights'>
							<label class="menulabel">Swords</label>
						</div>
					</div>
					<div id="scorebox">
						<input id="showvalue" type="checkbox" onclick="ShowScoresInBlocks()">
						<label for="showvalue" class="menulabel">Show scores</label>
					</div>
					<div id="buttongroup">
						<button id="applybutton" onclick="runGuaranteed()" class="menubutton">Apply</button>
						<button id="resetbutton" onclick="reset()" class="menubutton">Reset</button>
						<input id="liveupdate" type="checkbox" checked>
						<label id="liveupdatelabel" for="liveupdate">Live Update</label>
					</div>
				</div>
				<div id="wrapper">

					<div id="container1" class="block" onclick="LiveUpdate();"></div>
					<div id="container2" class="block" onclick="LiveUpdate();"></div>
					<div id="container3" class="block" onclick="LiveUpdate();"></div>
					<div id="container4" class="block" onclick="LiveUpdate();"></div>
					<div id="container5" class="block" onclick="LiveUpdate();"></div>
					<div id="container6" class="block" onclick="LiveUpdate();"></div>
					<div id="container7" class="block" onclick="LiveUpdate();"></div>
					<div id="container8" class="block" onclick="LiveUpdate();"></div>
					<div id="container9" class="block" onclick="LiveUpdate();"></div>
					<div id="container10" class="block" onclick="LiveUpdate();"></div>
					<div id="container11" class="block" onclick="LiveUpdate();"></div>
					<div id="container12" class="block" onclick="LiveUpdate();"></div>
					<div id="container13" class="block" onclick="LiveUpdate();"></div>
					<div id="container14" class="block" onclick="LiveUpdate();"></div>
					<div id="container15" class="block" onclick="LiveUpdate();"></div>
					<div id="container16" class="block" onclick="LiveUpdate();"></div>
					<div id="container17" class="block" onclick="LiveUpdate();"></div>
					<div id="container18" class="block" onclick="LiveUpdate();"></div>
					<div id="container19" class="block" onclick="LiveUpdate();"></div>
					<div id="container20" class="block" onclick="LiveUpdate();"></div>
					<div id="container21" class="block" onclick="LiveUpdate();"></div>
					<div id="container22" class="block" onclick="LiveUpdate();"></div>
					<div id="container23" class="block" onclick="LiveUpdate();"></div>
					<div id="container24" class="block" onclick="LiveUpdate();"></div>
					<div id="container25" class="block" onclick="LiveUpdate();"></div>
					<div id="container26" class="block" onclick="LiveUpdate();"></div>
					<div id="container27" class="block" onclick="LiveUpdate();"></div>
					<div id="container28" class="block" onclick="LiveUpdate();"></div>
					<div id="container29" class="block" onclick="LiveUpdate();"></div>
					<div id="container30" class="block" onclick="LiveUpdate();"></div>
					<div id="container31" class="block" onclick="LiveUpdate();"></div>
					<div id="container32" class="block" onclick="LiveUpdate();"></div>
					<div id="container33" class="block" onclick="LiveUpdate();"></div>
					<div id="container34" class="block" onclick="LiveUpdate();"></div>
					<div id="container35" class="block" onclick="LiveUpdate();"></div>
					<div id="container36" class="block" onclick="LiveUpdate();"></div>

				</div>

			</div>
			<div id="descriptionbox">
				<h3>
					Instructions
				</h3>
				<span class="description">
					Select a box type from the top of the left side bar.
				</span>
				<span class="description">
					Click on a box to apply the selected type.
				</span>
				<span class="description">
					Select a strategy and set weight values. Note: Weights only apply to "Weighted" strategy.
				</span>
				<span class="description">
					Click "Apply" to calculate the next move if live updates are off.
				</span>
				<h3>
					About
				</h3>
				<span class="description">
					This is my attempt at making a statistical approach to to the Faux Hollows minigame set to release in 5.3.
				</span>
				<span class="description">
					This, like other Faux Hollows solvers/calculators/simulators, having been created prior to the release of the content comes made with a number of basic assumptions:
				</span>
				<br>
				<span class="description indented">
					The grid will always be 6x6.
				</span>
				<span class="description indented">
					The coffer/gift box will always be 2x2.
				</span>
				<span class="description indented">
					The swords will always be either 2x3 or 3x2.
				</span>
				<span class="description indented">
					There will only be either a coffer <b>OR</b> a gift box.
				</span>
				<span class="description indented">
					One of each type will always spawn on the board.
				</span>
				<br>
				<span class="description">
					As such, the accuracy of this program is based purely on speculation.
				</span>
				<span class="description">
					This program should <b>NOT</b> be trusted until we know more about the minigame.
				</span>
				<br>
				<span class="description">
					Also, this is my first forray into web programming. If something breaks, send me a DM on Discord at Sturalke#0249. I'll do what I can to figure out what went wrong.
				</span>
				<span class="signature">
					Created by Fyrin Niyuun on Faerie.
				</span>
			</div>
		</div>
	</div>
</body>
</html>